# CUMT 成绩分析

中国矿业大学成绩单分析工具，支持导入 Excel 成绩单，计算加权绩点、可视化分析及 AI 智能诊断。

## 功能特性

- **📊 成绩导入**：支持 `.xlsx` 格式，自动解析课程、学分、成绩分项
- **📈 统计指标**：计算加权均分、加权绩点、总学分
- **⚙️ 规则设置**：
  - ×1.2 公共课倍率
  - 通识公选课处理
  - 首次不及格按 60 分计
  - 拓展课程组排除
- **📉 可视化图表**：
  - 成绩分布柱状图
  - 学期趋势折线图
- **🤖 AI 智能分析**：集成 SiliconFlow API，提供成绩诊断、学习规划、时间管理、职业建议
- **📤 导出报告**：支持导出 PDF/PNG 格式的成绩分析报告

## 快速开始

### 环境要求

- Node.js 18+
- pnpm / npm

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

### 构建生产版本

```bash
npm run build
```

## 使用说明

### 1. 导入成绩单

点击「导入表格」按钮，选择 `.xlsx` 格式的成绩单文件。工具会自动读取第一个工作表并解析课程数据。

### 2. 调整计算规则

点击「规则设置」可手动调整：
- **×1.2 公共课**：对高等数学、大学物理等公共基础课启用分数 ×1.2 加权
- **通识公选课**：处理通识公选课成绩
- **首次不及格**：勾选后该课程按 60 分、绩点 1.0 计算
- **拓展课程组**：在加权筛选时排除拓展课程组学分

### 3. 查看分析结果

- **加权均分**：推免加权计算范围内的平均分
- **加权绩点**：按推免规则计算的累计绩点
- **成绩分布**：查看各分数段课程数量
- **学期趋势**：查看各学期平均分变化

### 4. AI 智能分析

1. 在 AI 面板填写 SiliconFlow API Key
2. 选择模型（默认推荐 Qwen 系列）
3. 可选填写额外说明（如「想提升数学类课程」「规划考研」）
4. 点击「开始分析」获取诊断建议

### 5. 导出报告

点击「导出报告」可选择：
- **PDF**：导出完整的成绩分析报告
- **PNG**：导出为图片格式

## 文件格式要求

Excel 文件应包含以下列（表头不区分大小写）：

| 列名 | 说明 |
|------|------|
| 学年 | 如 2023-2024 |
| 学期 | 1 或 2 |
| 课程名称 | 课程全称 |
| 学分 | 课程学分 |
| 总评 | 最终成绩 |
| 分项名称（可选）| 如平时、期中、期末 |
| 分项成绩（可选）| 各分项分数 |
| 分项权重（可选）| 各分项占比 |

## 项目结构

```
src/
├── App.jsx              # 主应用组件
├── main.jsx             # 应用入口
├── components/
│   └── Charts.jsx       # 图表组件
├── utils/
│   ├── excel.js         # Excel 解析
│   ├── grade.js         # 成绩计算逻辑
│   ├── export.js        # 导出功能
│   └── constants.js     # 常量定义
└── styles.css           # 全局样式
```

## 技术栈

- **React 18** - UI 框架
- **Vite** - 构建工具
- **Chart.js + react-chartjs-2** - 图表
- **xlsx** - Excel 解析
- **html2canvas + jspdf** - 导出功能
- **React Markdown** - Markdown 渲染

##  License

MIT
